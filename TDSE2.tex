\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage[margin = 0.5cm]{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{fancyvrb}
\usepackage[dvipsnames]{xcolor}
%\title{Brief Article}
%\author{The Author}
%\date{}							% Activate to display a given date or no date

\begin{document}
\pagenumbering{gobble}
%\maketitle
%\section{}
%\subsection{}
{\color{black}
\begin{Verbatim}[commandchars=\\\{\}]

% --- Physical picture options:
% Potential options
% Default options:  wellheight = 100eV; wellwidth = 200nm; 
%                   well center = simulation window centre = n_gridpts/2
\textcolor{black}{wellheight = 80;}                  % Amplitude/Height of well in eV
wellwidth = 200;                   % Width of well in nm
potential = 'quadratic';           % Choose well type: 'free', 'square','quadratic'
well_centre_index = n_gridpts/2;   % The element index of the centre of the simulation canvas

% Particle wave options
% Default options:  wavelength = 30nm; wavepacket width = 20nm
wavelength = 30;                % in nm
s = 20;                         % Wavepacket width
wavecentre = 250;               % User input of wavecentre location
wavecentreindex = find(round(x) == wavecentre, 1);      % x is not in integer increments, thus requiring round. 
k = 2*pi/wavelength;            % Wavevector

%% Potential well set up
V = zeros(1, length(x));        % Initialize potential

% Switch carries out the code under the specified case when the 
% switch_expression is set to the case_expression. 
switch potential
    case 'free'             % No potential, free particle
        
    case 'quadratic'        % Quadratic/Harmonic trap
        V1 = rectangularPulse(L/2-wellwidth/2, L/2+wellwidth/2, x); % Imposing well boundaries
        quadfxn = @(x) (x-L/2).^2/10000;                            % Creating the basic well shape
        shift = feval(quadfxn, L/2-wellwidth/2);                    % Calculating the amount of shifting required for a well
        V = wellheight*V1.*(quadfxn(x)-shift);                      % Adjusting the well according to the required well height and boundaries
        
    case 'square'           % Square well
        lower_wall_index = well_centre_index - round(wellwidth/2);  % Determining corresponding element
        upper_wall_index = lower_wall_index + wellwidth;
        V(lower_wall_index:upper_wall_index) =  - wellheight;       % Setting the range of elements to the correct potential
    
    case 'doublequad'       % Double quadratic wells - for determining tunnelling possibilities
        V1 = rectangularPulse(L/2-wellwidth/2, L/2+wellwidth/2, x);         % Setting well boundaries
        quadfxn = @(x) ((x-L/2).^4-(wellwidth/2*(x-L/2)).^2)/(2.5*10^7);    % Creating the basic well shape
        V = wellheight.*V1.*quadfxn(x);                                     % Adjusting the final potential well according to the required height

    case 'step'           % Square well
        lower_wall_index = well_centre_index - round(wellwidth/2);  % Determining corresponding element
        upper_wall_index = lower_wall_index + wellwidth;
        V(lower_wall_index:upper_wall_index) =   wellheight;        % Setting the range of elements to the correct potential
end

%% Initial wavefxn
phi_r = zeros(1, length(x));        % Initializing wave array that stores 
phi_i = zeros(1, length(x));        % wave values at each gridpoint

% Calculate the initial value of each gridpoint. 
for nx = 1:n_gridpts
    phi_r(nx) = exp(-0.5*((x(nx)-x(wavecentreindex))/s).^2)*cos(k*(x(nx)-x(wavecentreindex)));
    phi_i(nx) = exp(-0.5*((x(nx)-x(wavecentreindex))/s).^2)*sin(k*(x(nx)-x(wavecentreindex)));
end
\end{Verbatim}
}

\end{document}  